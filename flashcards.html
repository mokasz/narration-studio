<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>æ—¥æœ¬ã®å…ƒå·ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰</title>
  <!-- Auto-sync enabled via GitHub Actions -->

  <!-- ============================================
       CSS STYLES
       ============================================ -->
  <style>
    /* ========== CSS Variables ========== */
    :root {
      --primary-color: #4A90E2;        /* ãƒ¡ã‚¤ãƒ³ã‚«ãƒ©ãƒ¼ï¼ˆé’ï¼‰ */
      --primary-hover: #357ABD;        /* ãƒ›ãƒãƒ¼æ™‚ã®è‰² */
      --background-color: #F5F7FA;     /* èƒŒæ™¯è‰² */
      --card-background: #FFFFFF;      /* ã‚«ãƒ¼ãƒ‰èƒŒæ™¯è‰² */
      --text-primary: #333333;         /* ãƒ¡ã‚¤ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè‰² */
      --text-secondary: #666666;       /* ã‚µãƒ–ãƒ†ã‚­ã‚¹ãƒˆè‰² */
      --text-hint: #999999;            /* ãƒ’ãƒ³ãƒˆãƒ†ã‚­ã‚¹ãƒˆè‰² */
      --border-color: #E1E4E8;         /* ãƒœãƒ¼ãƒ€ãƒ¼è‰² */
      --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.1);
      --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.15);
      --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.2);
      --border-radius: 12px;
      --transition-speed: 0.3s;
      --flip-speed: 0.6s;
    }

    /* ========== Reset & Base Styles ========== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans',
                   'Hiragino Kaku Gothic ProN', Meiryo, sans-serif;
      background-color: var(--background-color);
      color: var(--text-primary);
      line-height: 1.6;
      height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    /* ========== Layout ========== */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 15px;
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100%;
      overflow: hidden;
    }

    /* ========== Header ========== */
    header {
      text-align: center;
      margin-bottom: 10px;
      flex-shrink: 0;
      position: relative;
    }

    h1 {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-bottom: 5px;
      font-weight: 600;
    }

    .help-button {
      position: absolute;
      top: 0;
      right: 10px;
      background-color: var(--card-background);
      border: 2px solid var(--border-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1.2rem;
      color: var(--primary-color);
      transition: all var(--transition-speed);
      box-shadow: var(--shadow-sm);
    }

    .help-button:hover {
      background-color: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
      transform: scale(1.1);
      box-shadow: var(--shadow-md);
    }

    .help-button.hidden {
      display: none;
    }

    .header-subtitle {
      display: none; /* Hide subtitle to save space */
    }

    .header-info {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      flex-wrap: wrap;
      margin-top: 8px;
    }

    .progress-info {
      font-size: 1rem;
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .progress-bar-container {
      width: 200px;
      height: 8px;
      background-color: #E1E4E8;
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background-color: var(--primary-color);
      transition: width var(--transition-speed);
      width: 0%;
    }

    .group-filter {
      padding: 8px 16px;
      font-size: 0.95rem;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      background-color: var(--card-background);
      color: var(--text-primary);
      cursor: pointer;
      transition: all var(--transition-speed);
      font-family: inherit;
    }

    .group-filter:hover {
      border-color: var(--primary-color);
    }

    .group-filter:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
    }

    /* ========== Intro Screen ========== */
    .intro-screen {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      max-width: 700px;
      margin: 0 auto;
    }

    .intro-screen.hidden {
      display: none;
    }

    .intro-content {
      background-color: var(--card-background);
      border-radius: var(--border-radius);
      padding: 30px;
      box-shadow: var(--shadow-md);
      text-align: left;
    }

    .intro-title {
      font-size: 1.8rem;
      color: var(--primary-color);
      margin-bottom: 20px;
      text-align: center;
      font-weight: 600;
    }

    .intro-section {
      margin-bottom: 25px;
    }

    .intro-section h3 {
      font-size: 1.2rem;
      color: var(--text-primary);
      margin-bottom: 12px;
      font-weight: 600;
      border-left: 4px solid var(--primary-color);
      padding-left: 12px;
    }

    .intro-section p {
      font-size: 1rem;
      color: var(--text-secondary);
      line-height: 1.8;
      margin-bottom: 10px;
    }

    .intro-section ul {
      list-style: none;
      padding-left: 0;
    }

    .intro-section li {
      font-size: 0.95rem;
      color: var(--text-secondary);
      line-height: 1.8;
      margin-bottom: 8px;
      padding-left: 24px;
      position: relative;
    }

    .intro-section li::before {
      content: "âœ“";
      position: absolute;
      left: 0;
      color: var(--primary-color);
      font-weight: bold;
    }

    .btn-start {
      display: block;
      margin: 25px auto 0;
      padding: 14px 40px;
      font-size: 1.1rem;
      font-weight: 600;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all var(--transition-speed);
      box-shadow: var(--shadow-md);
    }

    .btn-start:hover {
      background-color: var(--primary-hover);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .btn-start:active {
      transform: translateY(0);
      box-shadow: var(--shadow-md);
    }

    .btn-close-intro {
      display: block;
      margin: 15px auto 0;
      padding: 10px 30px;
      font-size: 0.95rem;
      font-weight: 500;
      background-color: var(--card-background);
      color: var(--text-primary);
      border: 2px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
      transition: all var(--transition-speed);
    }

    .btn-close-intro:hover {
      border-color: var(--primary-color);
      color: var(--primary-color);
      transform: translateY(-1px);
    }

    .btn-close-intro.hidden {
      display: none;
    }

    /* ========== Main Card Area ========== */
    main {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      min-height: 0;
      overflow: hidden;
    }

    main.hidden {
      display: none;
    }

    .card-container {
      perspective: 1000px;
      width: 100%;
      max-width: 600px;
      height: 100%;
      max-height: 450px;
      display: flex;
      align-items: center;
    }

    .card {
      position: relative;
      width: 100%;
      height: 100%;
      cursor: pointer;
      transition: transform var(--flip-speed);
      transform-style: preserve-3d;
    }

    .card.flipped {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      background-color: var(--card-background);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-md);
      backface-visibility: hidden;
      display: flex;
      flex-direction: column;
      padding: 25px 20px;
      transition: box-shadow var(--transition-speed);
    }

    .card:hover .card-face {
      box-shadow: var(--shadow-lg);
    }

    .card-front {
      transform: rotateY(0deg);
    }

    .card-back {
      transform: rotateY(180deg);
    }

    .card-header {
      font-size: 0.85rem;
      color: var(--text-hint);
      margin-bottom: 10px;
      font-weight: 500;
      letter-spacing: 0.5px;
      flex-shrink: 0;
    }

    .card-content {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-size: 1.2rem;
      line-height: 1.8;
      color: var(--text-primary);
      overflow-y: auto;
      padding: 5px 0;
    }

    .card-back .card-content {
      font-size: 2rem;
      font-weight: 600;
      color: var(--primary-color);
    }

    .card-footer {
      margin-top: 10px;
      text-align: center;
      font-size: 0.8rem;
      color: var(--text-hint);
      font-style: italic;
      flex-shrink: 0;
    }

    /* ========== Controls ========== */
    .controls {
      margin-top: 10px;
      display: flex;
      justify-content: center;
      gap: 8px;
      flex-wrap: wrap;
      flex-shrink: 0;
    }

    .btn {
      padding: 8px 16px;
      font-size: 0.9rem;
      font-weight: 500;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: all var(--transition-speed);
      font-family: inherit;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: var(--shadow-sm);
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--primary-hover);
      box-shadow: var(--shadow-md);
      transform: translateY(-1px);
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: var(--shadow-sm);
    }

    .btn-secondary {
      background-color: var(--card-background);
      color: var(--text-primary);
      border: 2px solid var(--border-color);
    }

    .btn-secondary:hover {
      border-color: var(--primary-color);
      color: var(--primary-color);
      box-shadow: var(--shadow-md);
      transform: translateY(-1px);
    }

    .btn-secondary:active {
      transform: translateY(0);
      box-shadow: var(--shadow-sm);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }

    /* ========== Answer Buttons (Correct/Incorrect) ========== */
    .answer-buttons {
      margin-top: auto;
      padding-top: 15px;
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
      flex-shrink: 0;
    }

    .btn-correct,
    .btn-incorrect {
      flex: 1;
      min-width: 120px;
      max-width: 180px;
      font-weight: 600;
      padding: 10px 20px;
    }

    .btn-correct {
      background-color: #4CAF50;
      color: white;
    }

    .btn-correct:hover {
      background-color: #45a049;
      box-shadow: var(--shadow-md);
      transform: translateY(-1px);
    }

    .btn-incorrect {
      background-color: #f44336;
      color: white;
    }

    .btn-incorrect:hover {
      background-color: #da190b;
      box-shadow: var(--shadow-md);
      transform: translateY(-1px);
    }

    /* ========== Status Messages ========== */
    .status-message {
      text-align: center;
      margin-top: 8px;
      padding: 10px;
      border-radius: 6px;
      font-weight: 500;
      font-size: 0.9rem;
      min-height: 42px;
      visibility: hidden;
      opacity: 0;
      transition: opacity var(--transition-speed);
      flex-shrink: 0;
    }

    .status-message.visible {
      visibility: visible;
      opacity: 1;
    }

    .status-success {
      background-color: #E8F5E9;
      color: #2E7D32;
      border: 2px solid #4CAF50;
    }

    .status-info {
      background-color: #E3F2FD;
      color: #1565C0;
      border: 2px solid #2196F3;
    }

    /* ========== Incorrect Cards List ========== */
    .incorrect-list {
      background-color: #FFF3E0;
      border: 2px solid #FF9800;
      border-radius: 8px;
      padding: 20px;
      margin: 20px auto;
      max-width: 500px;
      text-align: left;
    }

    .incorrect-list h3 {
      color: #E65100;
      font-size: 1.1rem;
      margin-bottom: 15px;
      text-align: center;
    }

    .incorrect-list ul {
      list-style: none;
      padding-left: 0;
    }

    .incorrect-list li {
      padding: 8px 12px;
      margin-bottom: 8px;
      background-color: white;
      border-radius: 6px;
      font-size: 0.95rem;
      color: var(--text-primary);
      border-left: 4px solid #FF9800;
    }

    .incorrect-list .card-number {
      font-weight: 600;
      color: #E65100;
      margin-right: 8px;
    }

    .review-message {
      text-align: center;
      color: #E65100;
      font-size: 1rem;
      font-weight: 500;
      margin-top: 15px;
    }

    /* ========== Remaining Cards Counter ========== */
    .remaining-cards {
      text-align: center;
      margin-top: 8px;
      font-size: 1rem;
      color: var(--text-secondary);
      font-weight: 500;
      flex-shrink: 0;
    }

    .remaining-cards .count {
      font-size: 1.2rem;
      color: var(--primary-color);
      font-weight: 700;
    }

    /* ========== Footer ========== */
    footer {
      text-align: center;
      padding: 10px;
      color: var(--text-secondary);
      font-size: 0.75rem;
      border-top: 1px solid var(--border-color);
      margin-top: 10px;
      flex-shrink: 0;
    }

    .shortcuts {
      margin-top: 5px;
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .shortcut-item {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 0.7rem;
    }

    .key {
      background-color: var(--card-background);
      border: 1px solid var(--border-color);
      border-radius: 3px;
      padding: 1px 6px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 0.7rem;
      color: var(--text-primary);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    /* ========== Responsive Design ========== */
    /* Tablet and below */
    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }

      h1 {
        font-size: 1.4rem;
      }

      .header-info {
        gap: 10px;
      }

      .progress-bar-container {
        width: 120px;
      }

      .card-container {
        max-height: 400px;
      }

      .card-face {
        padding: 20px 15px;
      }

      .card-content {
        font-size: 1.25rem;
      }

      .card-back .card-content {
        font-size: 2rem;
      }

      .btn {
        padding: 7px 14px;
        font-size: 0.85rem;
      }

      .controls {
        gap: 6px;
        margin-top: 8px;
      }

      footer {
        padding: 8px;
        font-size: 0.7rem;
      }

      .shortcuts {
        gap: 8px;
      }

      .shortcut-item {
        font-size: 0.65rem;
      }

      .key {
        padding: 1px 4px;
        font-size: 0.65rem;
      }
    }

    /* Mobile Portrait */
    @media (max-width: 480px) {
      .container {
        padding: 8px;
      }

      h1 {
        font-size: 1.4rem;
        margin-bottom: 3px;
      }

      .intro-content {
        padding: 20px 15px;
      }

      .intro-title {
        font-size: 1.5rem;
      }

      .intro-section h3 {
        font-size: 1.05rem;
      }

      .intro-section p,
      .intro-section li {
        font-size: 0.9rem;
      }

      .btn-start {
        padding: 12px 30px;
        font-size: 1rem;
      }

      .incorrect-list {
        padding: 15px;
        margin: 15px 10px;
      }

      .incorrect-list h3 {
        font-size: 1rem;
      }

      .incorrect-list li {
        font-size: 0.9rem;
        padding: 6px 10px;
      }

      .help-button {
        width: 32px;
        height: 32px;
        font-size: 1rem;
        right: 5px;
      }

      .header-info {
        gap: 8px;
        margin-top: 5px;
      }

      .progress-bar-container {
        width: 100px;
        height: 6px;
      }

      .group-filter {
        font-size: 0.9rem;
        padding: 6px 12px;
      }

      .card-container {
        max-height: 350px;
      }

      .card-face {
        padding: 15px 12px;
      }

      .card-header {
        font-size: 0.85rem;
        margin-bottom: 8px;
      }

      .card-content {
        font-size: 1.3rem;
        line-height: 1.7;
      }

      .card-back .card-content {
        font-size: 2rem;
      }

      .card-footer {
        font-size: 0.8rem;
        margin-top: 8px;
      }

      .answer-buttons {
        gap: 8px;
        padding-top: 10px;
      }

      .btn-correct,
      .btn-incorrect {
        min-width: 110px;
        font-size: 0.95rem;
        padding: 10px 18px;
      }

      .btn {
        padding: 7px 14px;
        font-size: 0.9rem;
      }

      .controls {
        margin-top: 6px;
        gap: 5px;
      }

      .remaining-cards {
        font-size: 1rem;
        margin-top: 6px;
      }

      .remaining-cards .count {
        font-size: 1.3rem;
      }

      .status-message {
        font-size: 0.95rem;
        padding: 8px;
        margin-top: 6px;
      }

      footer {
        padding: 6px;
        margin-top: 6px;
      }
    }

    /* Landscape Mobile */
    @media (max-height: 600px) and (orientation: landscape) {
      .container {
        padding: 5px;
      }

      h1 {
        font-size: 1.1rem;
        margin-bottom: 2px;
      }

      .header-info {
        gap: 10px;
        margin-top: 3px;
      }

      .card-container {
        max-height: 300px;
      }

      .card-face {
        padding: 12px 15px;
      }

      .card-header {
        font-size: 0.75rem;
        margin-bottom: 5px;
      }

      .card-content {
        font-size: 0.95rem;
        line-height: 1.5;
      }

      .card-back .card-content {
        font-size: 1.4rem;
      }

      .card-footer {
        font-size: 0.7rem;
        margin-top: 5px;
      }

      .answer-buttons {
        padding-top: 8px;
      }

      .btn-correct,
      .btn-incorrect {
        padding: 7px 14px;
        font-size: 0.8rem;
      }

      .controls {
        margin-top: 5px;
      }

      .btn {
        padding: 5px 10px;
        font-size: 0.75rem;
      }

      .remaining-cards {
        font-size: 0.85rem;
        margin-top: 4px;
      }

      footer {
        padding: 4px;
        margin-top: 5px;
        font-size: 0.65rem;
      }

      .shortcuts {
        gap: 8px;
      }

      .shortcut-item {
        font-size: 0.6rem;
      }

      .key {
        font-size: 0.6rem;
        padding: 1px 4px;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- ============================================
         HEADER
         ============================================ -->
    <header>
      <button class="help-button hidden" id="help-button" title="ä½¿ã„æ–¹ã‚’è¦‹ã‚‹">ï¼Ÿ</button>
      <h1>æ—¥æœ¬ã®å…ƒå·ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰</h1>
      <p class="header-subtitle" style="color: var(--text-secondary); font-size: 0.85rem;">æ­´å²ã®é‡è¦ãªå…ƒå·ã‚’å­¦ç¿’</p>

      <div class="header-info">
        <div class="progress-info">
          <span>é€²æ—:</span>
          <strong id="current-card">1</strong>
          <span>/</span>
          <span id="total-cards">0</span>
          <div class="progress-bar-container">
            <div class="progress-bar" id="progress-bar"></div>
          </div>
        </div>

        <select class="group-filter" id="group-filter">
          <option value="all">ã™ã¹ã¦</option>
          <option value="group1">å¤ä»£ï¼ˆé£›é³¥ã€œå¥ˆè‰¯ï¼‰</option>
          <option value="group2">å¹³å®‰æ™‚ä»£</option>
          <option value="group3">éŒå€‰æ™‚ä»£</option>
          <option value="group4">éŒå€‰æœ«æœŸãƒ»å®¤ç”º</option>
          <option value="group5">å®‰åœŸæ¡ƒå±±ãƒ»æ±Ÿæˆ¸åˆæœŸ</option>
          <option value="group6">æ±Ÿæˆ¸æ™‚ä»£</option>
          <option value="group7">è¿‘ä»£ãƒ»ç¾ä»£</option>
        </select>
      </div>
    </header>

    <!-- ============================================
         INTRO SCREEN
         ============================================ -->
    <div class="intro-screen" id="intro-screen">
      <div class="intro-content">
        <h2 class="intro-title">æ—¥æœ¬ã®å…ƒå·ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰</h2>

        <div class="intro-section">
          <h3>ğŸ“š ã“ã®ã‚¢ãƒ—ãƒªã«ã¤ã„ã¦</h3>
          <p>æ—¥æœ¬ã®æ­´å²ã§é‡è¦ãª36å€‹ã®å…ƒå·ã‚’ã€æ­´å²çš„ãªå‡ºæ¥äº‹ã¨ä¸€ç·’ã«å­¦ç¿’ã§ãã‚‹ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ã‚¢ãƒ—ãƒªã§ã™ã€‚</p>
          <p><strong>å­¦ç¿’æ–¹æ³•ï¼š</strong>æ­´å²çš„ãªå‡ºæ¥äº‹ã‚„äººç‰©ã®èª¬æ˜ã‚’èª­ã¿ã€ã€‡ã€‡ã®éƒ¨åˆ†ã«å…¥ã‚‹å…ƒå·ã‚’è€ƒãˆã¾ã™ã€‚ã‚«ãƒ¼ãƒ‰ã‚’<span id="action-verb-1">ã‚¯ãƒªãƒƒã‚¯</span>ã—ã¦ç­”ãˆã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚</p>
        </div>

        <div class="intro-section">
          <h3>ğŸ¯ ä½¿ã„æ–¹</h3>
          <ul>
            <li>ã‚«ãƒ¼ãƒ‰ã‚’<span id="action-verb-2">ã‚¯ãƒªãƒƒã‚¯</span>ã—ã¦ç­”ãˆã‚’ç¢ºèª</li>
            <li>ã€Œæ­£è§£ã€ãƒœã‚¿ãƒ³ã§å­¦ç¿’å®Œäº†ã€ã€Œä¸æ­£è§£ã€ãƒœã‚¿ãƒ³ã§å¾Œã§å†å‡ºé¡Œ</li>
            <li>çŸ¢å°ã‚­ãƒ¼ï¼ˆâ†â†’ï¼‰ã‚„ã‚¹ãƒ¯ã‚¤ãƒ—ã§å‰å¾Œã®ã‚«ãƒ¼ãƒ‰ã«ç§»å‹•</li>
            <li>Spaceã‚­ãƒ¼ã§åè»¢ã€O/Xã‚­ãƒ¼ã§æ­£è§£/ä¸æ­£è§£ã‚’é¸æŠ</li>
            <li>ã‚°ãƒ«ãƒ¼ãƒ—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã§æ™‚ä»£åˆ¥ã«å­¦ç¿’å¯èƒ½</li>
            <li>å…¨å•æ­£è§£ã‚’ç›®æŒ‡ã—ã¦é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼</li>
          </ul>
        </div>

        <button class="btn-start" id="btn-start">ğŸ“ å­¦ç¿’ã‚’é–‹å§‹ã™ã‚‹</button>
        <button class="btn-close-intro hidden" id="btn-close-intro">é–‰ã˜ã‚‹</button>
      </div>
    </div>

    <!-- ============================================
         MAIN CARD AREA
         ============================================ -->
    <main id="main-area" class="hidden">
      <div class="card-container">
        <div class="card" id="flashcard">
          <!-- Front Face -->
          <div class="card-face card-front">
            <div class="card-header">å•é¡Œ 1</div>
            <div class="card-content" id="card-question">
              ã“ã“ã«å•é¡ŒãŒè¡¨ç¤ºã•ã‚Œã¾ã™
            </div>
            <div class="card-footer">ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç­”ãˆã‚’è¦‹ã‚‹</div>
          </div>

          <!-- Back Face -->
          <div class="card-face card-back">
            <div class="card-header">ç­”ãˆ</div>
            <div class="card-content" id="card-answer">
              ã“ã“ã«ç­”ãˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™
            </div>

            <!-- Answer Buttons (Inside Card) -->
            <div class="answer-buttons" id="answer-buttons">
              <button class="btn btn-correct" id="btn-correct">
                âœ“ æ­£è§£
              </button>
              <button class="btn btn-incorrect" id="btn-incorrect">
                âœ— ä¸æ­£è§£
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- ============================================
         CONTROLS
         ============================================ -->
    <div class="controls hidden" id="controls">
      <button class="btn btn-secondary" id="btn-prev">
        â† å‰ã¸
      </button>
      <button class="btn btn-secondary" id="btn-next">
        æ¬¡ã¸ â†’
      </button>
      <button class="btn btn-secondary" id="btn-random">
        âš„ ãƒ©ãƒ³ãƒ€ãƒ 
      </button>
    </div>

    <!-- Remaining Cards Counter -->
    <div class="remaining-cards hidden" id="remaining-cards">
      æ®‹ã‚Šã®ã‚«ãƒ¼ãƒ‰: <span class="count" id="remaining-count">0</span>æš
    </div>

    <!-- Status Messages -->
    <div class="status-message hidden" id="status-message"></div>

    <!-- ============================================
         FOOTER
         ============================================ -->
    <footer class="hidden" id="footer">
      <p>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ</p>
      <div class="shortcuts">
        <div class="shortcut-item">
          <span class="key">â†</span>
          <span class="key">â†’</span>
          <span>å‰å¾Œã®ã‚«ãƒ¼ãƒ‰</span>
        </div>
        <div class="shortcut-item">
          <span class="key">Space</span>
          <span class="key">Enter</span>
          <span>ã‚«ãƒ¼ãƒ‰ã‚’åè»¢</span>
        </div>
        <div class="shortcut-item">
          <span class="key">O</span>
          <span>æ­£è§£</span>
        </div>
        <div class="shortcut-item">
          <span class="key">X</span>
          <span>ä¸æ­£è§£</span>
        </div>
        <div class="shortcut-item">
          <span class="key">R</span>
          <span>ãƒ©ãƒ³ãƒ€ãƒ </span>
        </div>
      </div>
    </footer>
  </div>

  <!-- ============================================
       FLASHCARD DATA: æ—¥æœ¬ã®å…ƒå·36å•
       ============================================ -->
  <script>
    const FLASHCARD_DATA = [
      // å¤ä»£ï¼ˆé£›é³¥ã€œå¥ˆè‰¯æ™‚ä»£ï¼‰group 1
      {
        id: 1,
        question: "åˆã‚ã¦å®šã‚ã‚‰ã‚ŒãŸå…ƒå·ã€‚ä¸­å¤§å…„çš‡å­ï¼ˆãªã‹ã®ãŠãŠãˆã®ãŠã†ã˜ï¼‰ã‚’ä¸­å¿ƒã«ã—ãŸä¸€é€£ã®æ”¿æ²»æ”¹é©ã¯ã€ã€‡ã€‡ã®æ”¹æ–°ã€‚",
        answer: "å¤§åŒ–ï¼ˆãŸã„ã‹ï¼‰",
        group: 1
      },
      {
        id: 2,
        question: "é£›é³¥æ™‚ä»£ã®701å¹´ã«ã€ã€‡ã€‡å¾‹ä»¤ãŒå®šã‚ã‚‰ã‚Œã‚‹ã€‚",
        answer: "å¤§å®ï¼ˆãŸã„ã»ã†ï¼‰",
        group: 1
      },
      {
        id: 3,
        question: "é£›é³¥æ™‚ä»£ã®708å¹´ã«ã€å’ŒåŒé–‹çãŒã¤ãã‚‰ã‚Œã‚‹ã€‚",
        answer: "å’ŒéŠ…ï¼ˆã‚ã©ã†ï¼‰ã€éŠ…ã®å­—ã¯è¦æ³¨æ„",
        group: 1
      },
      {
        id: 4,
        question: "è–æ­¦å¤©çš‡ãŒç”¨ã„ãŸå…ƒå·ã€‚å¥ˆè‰¯æ™‚ä»£ã®æ–‡åŒ–ã¯ã€‡ã€‡æ–‡åŒ–ã€‚",
        answer: "å¤©å¹³ï¼ˆã¦ã‚“ã´ã‚‡ã†ï¼‰",
        group: 1
      },
      {
        id: 5,
        question: "æ¡“æ­¦å¤©çš‡ãŒç”¨ã„ãŸå…ƒå·ã€‚æœ€æ¾„ãŒæ¯”å¡å±±ã«ã€‡ã€‡å¯ºã‚’å»ºã¦ã€å¤©å°å®—ã‚’ä¼ãˆãŸã€‚",
        answer: "å»¶æš¦ï¼ˆãˆã‚“ã‚Šã‚ƒãï¼‰",
        group: 1
      },

      // å¹³å®‰æ™‚ä»£ group 2
      {
        id: 6,
        question: "å¹³å®‰æ™‚ä»£ã®935å¹´ã€å¹³å°†é–€ãŒä¸‹ç·å›½ã§åä¹±ã‚’èµ·ã“ã™ã€‚",
        answer: "æ‰¿å¹³ï¼ˆã˜ã‚‡ã†ã¸ã„ï¼‰",
        group: 2
      },
      {
        id: 7,
        question: "å¹³å®‰æ™‚ä»£ã®939å¹´ã€è—¤åŸç´”å‹ãŒè¥¿å›½ã§åä¹±ã‚’èµ·ã“ã™ã€‚ (*) å¹³å°†é–€ã®ä¹±ã¨è—¤åŸç´”å‹ã®ä¹±ã‚’ã‚ã‚ã›ã¦ã€æ‰¿å¹³ãƒ»ã€‡ã€‡ã®ä¹±ã¨ã‚ˆã¶ã“ã¨ãŒã‚ã‚‹ã€‚",
        answer: "å¤©æ…¶ï¼ˆã¦ã‚“ãã‚‡ã†ï¼‰",
        group: 2
      },
      {
        id: 8,
        question: "å¹³å®‰æ™‚ä»£ã®1156å¹´ã€å¤©çš‡ã¨ä¸Šçš‡ã®å¯¾ç«‹ãŒå¼•ããŒã­ã«ãªã£ã¦ã€‡ã€‡ã®ä¹±ãŒèµ·ã“ã‚‹ã€‚",
        answer: "ä¿å…ƒï¼ˆã»ã†ã’ã‚“ï¼‰",
        group: 2
      },
      {
        id: 9,
        question: "å¹³å®‰æ™‚ä»£ã®1159å¹´ã€ä¿å…ƒã®ä¹±ã¨ã¨ã‚‚ã«å¤©çš‡æ–¹ã ã£ãŸå¹³æ¸…ç››ã¨æºç¾©æœãŒå¯¾ç«‹ã—ã€ã€‡ã€‡ã®ä¹±ãŒèµ·ã“ã‚‹ã€‚",
        answer: "å¹³æ²»ï¼ˆã¸ã„ã˜ï¼‰",
        group: 2
      },

      // éŒå€‰æ™‚ä»£ group 3
      {
        id: 10,
        question: "éŒå€‰æ™‚ä»£ã®1221å¹´ã€å¾Œé³¥ç¾½ä¸Šçš‡ãŒåŒ—æ¡ç¾©æ™‚ã‚’è¨ã¦ã¨å‘½ä»¤ã—ã€ã€‡ã€‡ã®ä¹±ãŒèµ·ã“ã‚‹ã€‚",
        answer: "æ‰¿ä¹…ï¼ˆã˜ã‚‡ã†ãã‚…ã†ï¼‰",
        group: 3
      },
      {
        id: 11,
        question: "éŒå€‰æ™‚ä»£ã®1232å¹´ã€3ä»£åŸ·æ¨©ã®åŒ—æ¡æ³°æ™‚ãŒå¾¡æˆæ•—å¼ç›®(ã€‡ã€‡å¼ç›®)ã‚’å®šã‚ã‚‹ã€‚",
        answer: "è²æ°¸ï¼ˆã˜ã‚‡ã†ãˆã„ï¼‰",
        group: 3
      },
      {
        id: 12,
        question: "éŒå€‰æ™‚ä»£ã®1274å¹´ã«ã€å…ƒè»ãŒæ”»ã‚ã¦ããŸã€‡ã€‡ã®å½¹ã€‚",
        answer: "æ–‡æ°¸ï¼ˆã¶ã‚“ãˆã„ï¼‰",
        group: 3
      },
      {
        id: 13,
        question: "éŒå€‰æ™‚ä»£ã®1281å¹´ã«ã€å…ƒè»ãŒå†ã³æ”»ã‚ã¦ããŸã€‡ã€‡ã®å½¹ã€‚",
        answer: "å¼˜å®‰ï¼ˆã“ã†ã‚ã‚“ï¼‰",
        group: 3
      },
      {
        id: 14,
        question: "1297å¹´ã€éŒå€‰å¹•åºœãŒã€‡ã€‡ã®å¾³æ”¿ä»¤ã‚’ç™ºå¸ƒã€‚",
        answer: "æ°¸ä»ï¼ˆãˆã„ã«ã‚“ï¼‰",
        group: 3
      },

      // éŒå€‰æœ«æœŸãƒ»å®¤ç”ºæ™‚ä»£ group 4
      {
        id: 15,
        question: "1334å¹´ã€å¾Œé†é†å¤©çš‡ã¯å…ƒå·ã‚’ã€‡ã€‡ã¨æ”¹ã‚ã€è‡ªã‚‰è¡Œã£ãŸæ”¿æ²»ã¯ã€‡ã€‡ã®æ–°æ”¿ã¨ã‚ˆã°ã‚Œã‚‹ã€‚",
        answer: "å»ºæ­¦ï¼ˆã‘ã‚“ã‚€ï¼‰",
        group: 4
      },
      {
        id: 16,
        question: "å®¤ç”ºæ™‚ä»£ã®1428å¹´ã€è¿‘æ±Ÿå›½ã®é¦¬å€Ÿã‚‰ãŒã€‡ã€‡ã®åœŸä¸€æ†ã‚’èµ·ã“ã™ã€‚",
        answer: "æ­£é•·ï¼ˆã—ã‚‡ã†ã¡ã‚‡ã†ï¼‰",
        group: 4
      },
      {
        id: 17,
        question: "å®¤ç”ºæ™‚ä»£ã®1467å¹´ã€8ä»£å°†è»è¶³åˆ©ç¾©æ”¿ã®ã‚ã¨ç¶™ãäº‰ã„ãªã©ã«ã‚ˆã‚Šã€ã€‡ã€‡ã®ä¹±ãŒèµ·ã“ã‚‹ã€‚",
        answer: "å¿œä»ï¼ˆãŠã†ã«ã‚“ï¼‰",
        group: 4
      },

      // å®‰åœŸæ¡ƒå±±ãƒ»æ±Ÿæˆ¸åˆæœŸ group 5
      {
        id: 18,
        question: "å®‰åœŸãƒ»æ¡ƒå±±æ™‚ä»£ã®1582å¹´ã€ä¹å·ã®ã‚­ãƒªã‚·ã‚¿ãƒ³å¤§åã«ã‚ˆã£ã¦ã€‡ã€‡é£æ¬§ä½¿ç¯€å›£ãŒæ´¾é£ã€‚",
        answer: "å¤©æ­£ï¼ˆã¦ã‚“ã—ã‚‡ã†ï¼‰",
        group: 5
      },
      {
        id: 19,
        question: "å®‰åœŸãƒ»æ¡ƒå±±æ™‚ä»£ã®1592å¹´ã€è±Šè‡£ç§€å‰ã«ã‚ˆã‚‹ä¸€åº¦ç›®ã®æœé®®ä¾µç•¥ã¯ã€‡ã€‡ã®å½¹ã€‚",
        answer: "æ–‡ç¦„ï¼ˆã¶ã‚“ã‚ãï¼‰",
        group: 5
      },
      {
        id: 20,
        question: "å®‰åœŸãƒ»æ¡ƒå±±æ™‚ä»£ã®1597å¹´ã€è±Šè‡£ç§€å‰ã«ã‚ˆã‚‹äºŒåº¦ç›®ã®æœé®®ä¾µç•¥ã¯ã€‡ã€‡ã®å½¹ã€‚",
        answer: "æ…¶é•·ï¼ˆã‘ã„ã¡ã‚‡ã†ï¼‰",
        group: 5
      },
      {
        id: 21,
        question: "1615å¹´ã€2ä»£å°†è»å¾³å·ç§€å¿ ã®ã¨ãã«åˆã‚ã¦å®šã‚ã‚‰ã‚ŒãŸæ­¦å®¶è«¸æ³•åº¦ã¯ã€ã€‡ã€‡ä»¤ã¨ã‚‚ã‚ˆã°ã‚Œã‚‹ã€‚",
        answer: "å…ƒå’Œï¼ˆã’ã‚“ãªï¼‰",
        group: 5
      },
      {
        id: 22,
        question: "1635å¹´ã€3ä»£å°†è»å¾³å·å®¶å…‰ãŒæ”¹ã‚ã€å‚å‹¤äº¤ä»£ã‚’å®šã‚ãŸæ­¦å®¶è«¸æ³•åº¦ã¯ã€ã€‡ã€‡ä»¤ã¨ã‚‚ã‚ˆã°ã‚Œã‚‹ã€‚ç¦ä»¤ã§å¹•åºœé€šé”ãŒå¤§é‡ã«ã¤ãã‚‰ã‚Œã€é–å›½ãŒå…¨å›½ã«æ™®åŠã™ã‚‹ã€‚",
        answer: "å¯›æ°¸ï¼ˆã‹ã‚“ãˆã„ï¼‰",
        group: 5
      },

      // æ±Ÿæˆ¸æ™‚ä»£ group 6
      {
        id: 23,
        question: "æ±Ÿæˆ¸æ™‚ä»£ã®1657å¹´ã€ã€‡ã€‡ã®å¤§ç«ã«ã‚ˆã‚Šã€æ±Ÿæˆ¸åŸã®å¤©å®ˆé–£ãŒç„¼å¤±ã€‚",
        answer: "æ˜æš¦ï¼ˆã‚ã„ã‚Œãï¼‰",
        group: 6
      },
      {
        id: 24,
        question: "5ä»£å°†è»å¾³å·ç¶±å‰ã®ã“ã‚ã®å…ƒå·ã€‚äº•åŸè¥¿é¶´ãƒ»è¿‘æ¾é–€å·¦è¡›é–€ã‚‰ãŒæ´»èºã—ãŸã€‡ã€‡æ–‡åŒ–ã€‚",
        answer: "å…ƒç¦„ï¼ˆã’ã‚“ã‚ãï¼‰",
        group: 6
      },
      {
        id: 25,
        question: "é•·å´ã§ã®è²¿æ˜“ã‚’åˆ¶é™ã™ã‚‹ãªã©ã®æ–°äº•ç™½çŸ³ã«ã‚ˆã‚‹ã€‡ã€‡ã®æ²»ã€‚",
        answer: "æ­£å¾³ï¼ˆã—ã‚‡ã†ã¨ãï¼‰",
        group: 6
      },
      {
        id: 26,
        question: "8ä»£å°†è»å¾³å·å‰å®—ã®ã“ã‚ã®å…ƒå·ã€‚ä¸Šç±³ã®åˆ¶ã€ç›®å®‰ç®±è¨­ç½®ãªã©ã®ã€‡ã€‡ã®æ”¹é©ã€‚",
        answer: "äº«ä¿ï¼ˆãã‚‡ã†ã»ã†ï¼‰",
        group: 6
      },
      {
        id: 27,
        question: "1782å¹´ã€œ1787å¹´ã€é•·é›¨ã¨æµ…é–“å±±ã®å™´ç«ãƒ»å†·å®³ãªã©ã«ã‚ˆã‚‹ã€‡ã€‡ã®å¤§ããã‚“ã€‚",
        answer: "å¤©æ˜ï¼ˆã¦ã‚“ã‚ã„ï¼‰",
        group: 6
      },
      {
        id: 28,
        question: "å¹•åºœã®å­¦æ ¡ã§æœ±å­å­¦ä»¥å¤–ã®è¬›ç¾©ã‚’ç¦ã˜ã‚‹ãªã©ã€è€ä¸­ã®æ¾å¹³å®šä¿¡ã«ã‚ˆã‚‹ã€‡ã€‡ã®æ”¹é©ã€‚",
        answer: "å¯›æ”¿ï¼ˆã‹ã‚“ã›ã„ï¼‰",
        group: 6
      },
      {
        id: 29,
        question: "åè¿”èˆä¸€ä¹ãƒ»è‘›é£¾åŒ—æ–ãƒ»æ­Œå·åºƒé‡ã‚‰ãŒæ´»èºã—ãŸåŒ–æ”¿æ–‡åŒ–ã€‚",
        answer: "æ–‡åŒ–ãƒ»æ–‡æ”¿ï¼ˆã¶ã‚“ã‹ãƒ»ã¶ã‚“ã›ã„ï¼‰",
        group: 6
      },
      {
        id: 30,
        question: "1837å¹´ã€ã€‡ã€‡ã®å¤§ããã‚“ã§è‹¦ã—ã‚€äººã€…ã‚’æ•‘ãŠã†ã¨èµ·ã“ã•ã‚ŒãŸå¤§å¡©å¹³å…«éƒã®ä¹±ã€‚ æ ªä»²é–“ã®è§£æ•£ãªã©ã€è€ä¸­ã®æ°´é‡å¿ é‚¦ã«ã‚ˆã‚‹ã€‡ã€‡ã®æ”¹é©ã€‚",
        answer: "å¤©ä¿ï¼ˆã¦ã‚“ã½ã†ï¼‰",
        group: 6
      },
      {
        id: 31,
        question: "1858å¹´ã®æ—¥ç±³ä¿®å¥½é€šå•†æ¡ç´„ã‚’ã¯ã˜ã‚ã¨ã™ã‚‹ã€‡ã€‡ã®äº”ã‹å›½æ¡ç´„ã€å¤§è€ã®äº•ä¼Šç›´å¼¼ã«ã‚ˆã‚‹ã€‡ã€‡ã®å¤§ç„ã€‚",
        answer: "å®‰æ”¿ï¼ˆã‚ã‚“ã›ã„ï¼‰",
        group: 6
      },
      {
        id: 32,
        question: "æ±Ÿæˆ¸æ™‚ä»£ã€æœ€å¾Œã®å…ƒå·ã€‚",
        answer: "æ…¶å¿œï¼ˆã‘ã„ãŠã†ï¼‰",
        group: 6
      },

      // è¿‘ä»£ãƒ»ç¾ä»£ group 7
      {
        id: 33,
        question: "ã€‡ã€‡å…ƒå¹´=1868å¹´ã€œã€‡ã€‡45å¹´=1912å¹´",
        answer: "æ˜æ²»ï¼ˆã‚ã„ã˜ï¼‰",
        group: 7
      },
      {
        id: 34,
        question: "ã€‡ã€‡å…ƒå¹´=1912å¹´ã€œã€‡ã€‡15å¹´=1926å¹´",
        answer: "å¤§æ­£ï¼ˆãŸã„ã—ã‚‡ã†ï¼‰",
        group: 7
      },
      {
        id: 35,
        question: "ã€‡ã€‡å…ƒå¹´=1926å¹´ã€œã€‡ã€‡64å¹´=1989å¹´",
        answer: "æ˜­å’Œï¼ˆã—ã‚‡ã†ã‚ï¼‰",
        group: 7
      },
      {
        id: 36,
        question: "ã€‡ã€‡å…ƒå¹´=1989å¹´ã€œã€‡ã€‡31å¹´=2019å¹´",
        answer: "å¹³æˆï¼ˆã¸ã„ã›ã„ï¼‰",
        group: 7
      }
    ];
  </script>

  <!-- ============================================
       APPLICATION LOGIC
       ============================================ -->
  <script>
    // Configuration
    const USE_GROUP_FILTER = true;

    // State Management
    let currentIndex = 0;
    let isFlipped = false;
    let currentFilter = 'all';
    let allCards = [...FLASHCARD_DATA];
    let filteredCards = [...FLASHCARD_DATA];
    let learningQueue = [...FLASHCARD_DATA];
    let masteredCards = [];
    let incorrectCards = [];

    // DOM Elements
    const introScreen = document.getElementById('intro-screen');
    const mainArea = document.getElementById('main-area');
    const btnStart = document.getElementById('btn-start');
    const btnCloseIntro = document.getElementById('btn-close-intro');
    const helpButton = document.getElementById('help-button');
    const actionVerb1 = document.getElementById('action-verb-1');
    const actionVerb2 = document.getElementById('action-verb-2');
    const controls = document.getElementById('controls');
    const remainingCardsDiv = document.getElementById('remaining-cards');
    const footer = document.getElementById('footer');
    const flashcard = document.getElementById('flashcard');
    const cardQuestion = document.getElementById('card-question');
    const cardAnswer = document.getElementById('card-answer');
    const currentCardSpan = document.getElementById('current-card');
    const totalCardsSpan = document.getElementById('total-cards');
    const progressBar = document.getElementById('progress-bar');
    const btnPrev = document.getElementById('btn-prev');
    const btnNext = document.getElementById('btn-next');
    const btnRandom = document.getElementById('btn-random');
    const answerButtons = document.getElementById('answer-buttons');
    const btnCorrect = document.getElementById('btn-correct');
    const btnIncorrect = document.getElementById('btn-incorrect');
    const remainingCount = document.getElementById('remaining-count');
    const statusMessage = document.getElementById('status-message');
    const groupFilter = document.getElementById('group-filter');

    // Device Detection
    function isTouchDevice() {
      return (('ontouchstart' in window) ||
              (navigator.maxTouchPoints > 0) ||
              (navigator.msMaxTouchPoints > 0));
    }

    // Set action verbs based on device type
    function setActionVerbs() {
      const actionText = isTouchDevice() ? 'ã‚¿ãƒƒãƒ—' : 'ã‚¯ãƒªãƒƒã‚¯';
      actionVerb1.textContent = actionText;
      actionVerb2.textContent = actionText;
    }

    // Show Intro Screen
    function showIntro() {
      introScreen.classList.remove('hidden');
      mainArea.classList.add('hidden');
      controls.classList.add('hidden');
      remainingCardsDiv.classList.add('hidden');
      footer.classList.add('hidden');
      statusMessage.classList.add('hidden');
      helpButton.classList.add('hidden');

      // Show appropriate button based on context
      if (learningQueue.length < filteredCards.length || masteredCards.length > 0) {
        btnStart.classList.add('hidden');
        btnCloseIntro.classList.remove('hidden');
      } else {
        btnStart.classList.remove('hidden');
        btnCloseIntro.classList.add('hidden');
      }
    }

    // Hide Intro Screen
    function hideIntro() {
      introScreen.classList.add('hidden');
      mainArea.classList.remove('hidden');
      controls.classList.remove('hidden');
      remainingCardsDiv.classList.remove('hidden');
      footer.classList.remove('hidden');
      statusMessage.classList.remove('hidden');
      helpButton.classList.remove('hidden');
    }

    // Hide group filter if not used
    if (!USE_GROUP_FILTER) {
      groupFilter.style.display = 'none';
    }

    // Initialize
    setActionVerbs();
    updateTotalCardsDisplay();
    updateRemainingCount();
    disableAnswerButtons();
    renderCard();

    // Group Filter Change
    groupFilter.addEventListener('change', (e) => {
      currentFilter = e.target.value;
      applyFilter();
    });

    // Apply Filter
    function applyFilter() {
      masteredCards = [];
      incorrectCards = [];

      if (currentFilter === 'all') {
        filteredCards = [...allCards];
      } else if (currentFilter.startsWith('group')) {
        const groupNum = parseInt(currentFilter.replace('group', ''));
        filteredCards = allCards.filter(card => card.group === groupNum);
      }

      learningQueue = [...filteredCards];
      currentIndex = 0;
      isFlipped = false;

      updateTotalCardsDisplay();
      updateRemainingCount();
      resetFlip();
      renderCard();
      hideStatusMessage();

      flashcard.style.display = 'block';
      controls.style.display = 'flex';
      remainingCardsDiv.style.display = 'block';
    }

    function updateTotalCardsDisplay() {
      totalCardsSpan.textContent = filteredCards.length;
    }

    function renderCard() {
      if (learningQueue.length === 0) {
        showCompletionMessage();
        return;
      }

      const card = learningQueue[currentIndex];
      const cardHeader = flashcard.querySelector('.card-front .card-header');

      cardHeader.textContent = `å•é¡Œ ${card.id}`;
      cardQuestion.textContent = card.question;
      cardAnswer.textContent = card.answer;

      hideStatusMessage();
      updateProgress();
      updateButtons();
    }

    function updateProgress() {
      const mastered = masteredCards.length;
      const total = filteredCards.length;
      currentCardSpan.textContent = mastered;
      const percentage = total > 0 ? (mastered / total) * 100 : 0;
      progressBar.style.width = `${percentage}%`;
    }

    function updateButtons() {
      btnPrev.disabled = currentIndex === 0;
      btnNext.disabled = currentIndex >= learningQueue.length - 1;
      btnRandom.disabled = learningQueue.length <= 1;
    }

    // Enable/Disable Answer Buttons
    function enableAnswerButtons() {
      btnCorrect.disabled = false;
      btnIncorrect.disabled = false;
    }

    function disableAnswerButtons() {
      btnCorrect.disabled = true;
      btnIncorrect.disabled = true;
    }

    function updateRemainingCount() {
      remainingCount.textContent = learningQueue.length;
    }

    function flipCard() {
      isFlipped = !isFlipped;
      flashcard.classList.toggle('flipped');

      if (isFlipped) {
        enableAnswerButtons();
      } else {
        disableAnswerButtons();
      }
    }

    function resetFlip() {
      if (isFlipped) {
        isFlipped = false;
        flashcard.classList.remove('flipped');
        disableAnswerButtons();
      }
    }

    function handleCorrect() {
      disableAnswerButtons();

      const card = learningQueue[currentIndex];
      masteredCards.push(card);
      learningQueue.splice(currentIndex, 1);
      updateRemainingCount();
      updateProgress();
      showStatusMessage(`æ­£è§£ï¼ æ®‹ã‚Š${learningQueue.length}æš`, 'success');

      setTimeout(() => {
        if (learningQueue.length === 0) {
          showCompletionMessage();
        } else {
          if (currentIndex >= learningQueue.length) {
            currentIndex = 0;
          }
          resetFlip();
          renderCard();
        }
      }, 1000);
    }

    function handleIncorrect() {
      disableAnswerButtons();

      const card = learningQueue[currentIndex];

      if (!incorrectCards.find(c => c.id === card.id)) {
        incorrectCards.push(card);
      }

      learningQueue.splice(currentIndex, 1);
      learningQueue.push(card);

      showStatusMessage('ã‚‚ã†ä¸€åº¦å¾©ç¿’ã—ã¾ã—ã‚‡ã†', 'info');

      setTimeout(() => {
        if (currentIndex >= learningQueue.length) {
          currentIndex = 0;
        }
        resetFlip();
        renderCard();
      }, 1000);
    }

    function showStatusMessage(message, type) {
      statusMessage.textContent = message;
      statusMessage.className = `status-message visible status-${type}`;
    }

    function hideStatusMessage() {
      statusMessage.classList.remove('visible');
      while (statusMessage.firstChild) {
        statusMessage.removeChild(statusMessage.firstChild);
      }
    }

    function showCompletionMessage() {
      flashcard.style.display = 'none';

      const filterText = currentFilter === 'all'
        ? `å…¨${filteredCards.length}å•`
        : `${filteredCards.length}å•`;

      showStatusMessage(`ğŸ‰ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼${filterText}æ­£è§£ã—ã¾ã—ãŸï¼`, 'success');

      if (incorrectCards.length > 0) {
        const incorrectListDiv = document.createElement('div');
        incorrectListDiv.className = 'incorrect-list';

        const heading = document.createElement('h3');
        heading.textContent = 'âš ï¸ é–“é•ãˆãŸå•é¡Œï¼ˆå¾©ç¿’ãŒå¿…è¦ï¼‰';
        incorrectListDiv.appendChild(heading);

        const ul = document.createElement('ul');
        incorrectCards.forEach(card => {
          const li = document.createElement('li');
          const cardNumber = document.createElement('span');
          cardNumber.className = 'card-number';
          cardNumber.textContent = `å•é¡Œ${card.id}:`;
          li.appendChild(cardNumber);
          const answerText = card.answer || `${card.question}`;
          li.appendChild(document.createTextNode(` ${answerText}`));
          ul.appendChild(li);
        });
        incorrectListDiv.appendChild(ul);

        const reviewMsg = document.createElement('div');
        reviewMsg.className = 'review-message';
        reviewMsg.textContent = 'ğŸ’¡ ã“ã‚Œã‚‰ã®å•é¡Œã‚’ã‚‚ã†ä¸€åº¦å¾©ç¿’ã—ã¾ã—ã‚‡ã†ï¼';
        incorrectListDiv.appendChild(reviewMsg);

        statusMessage.appendChild(incorrectListDiv);
      }

      const restartBtn = document.createElement('button');
      restartBtn.className = 'btn btn-primary';
      restartBtn.textContent = 'æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™';
      restartBtn.style.marginTop = '20px';
      restartBtn.onclick = restartLearning;

      statusMessage.appendChild(document.createElement('br'));
      statusMessage.appendChild(restartBtn);

      controls.style.display = 'none';
      remainingCardsDiv.style.display = 'none';
    }

    function restartLearning() {
      learningQueue = [...filteredCards];
      masteredCards = [];
      incorrectCards = [];
      currentIndex = 0;
      isFlipped = false;

      flashcard.classList.remove('flipped');
      disableAnswerButtons();

      flashcard.style.display = 'block';
      controls.style.display = 'flex';
      remainingCardsDiv.style.display = 'block';

      updateRemainingCount();
      hideStatusMessage();
      renderCard();
    }

    function nextCard() {
      if (currentIndex < learningQueue.length - 1) {
        currentIndex++;
        resetFlip();
        renderCard();
      }
    }

    function prevCard() {
      if (currentIndex > 0) {
        currentIndex--;
        resetFlip();
        renderCard();
      }
    }

    function randomCard() {
      if (learningQueue.length <= 1) return;

      const newIndex = Math.floor(Math.random() * learningQueue.length);
      if (newIndex !== currentIndex) {
        currentIndex = newIndex;
        resetFlip();
        renderCard();
      } else {
        randomCard();
      }
    }

    // Event Listeners - Click
    flashcard.addEventListener('click', flipCard);
    btnPrev.addEventListener('click', prevCard);
    btnNext.addEventListener('click', nextCard);
    btnRandom.addEventListener('click', randomCard);

    btnCorrect.addEventListener('click', (e) => {
      e.stopPropagation();
      handleCorrect();
    });
    btnIncorrect.addEventListener('click', (e) => {
      e.stopPropagation();
      handleIncorrect();
    });

    // Event Listeners - Keyboard
    document.addEventListener('keydown', (e) => {
      if (isFlipped) {
        if (e.key === 'o' || e.key === 'O') {
          e.preventDefault();
          handleCorrect();
          return;
        }
        if (e.key === 'x' || e.key === 'X') {
          e.preventDefault();
          handleIncorrect();
          return;
        }
      }

      switch(e.key) {
        case 'ArrowLeft':
          prevCard();
          break;
        case 'ArrowRight':
          nextCard();
          break;
        case ' ':
        case 'Enter':
          e.preventDefault();
          flipCard();
          break;
        case 'r':
        case 'R':
          randomCard();
          break;
      }
    });

    // Touch Gestures (Swipe)
    let touchStartX = 0;
    let touchEndX = 0;

    flashcard.addEventListener('touchstart', (e) => {
      touchStartX = e.changedTouches[0].screenX;
    }, { passive: true });

    flashcard.addEventListener('touchend', (e) => {
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
    }, { passive: true });

    function handleSwipe() {
      const swipeThreshold = 50;
      const diff = touchStartX - touchEndX;

      if (Math.abs(diff) > swipeThreshold) {
        if (diff > 0) {
          nextCard();
        } else {
          prevCard();
        }
      }
    }

    // Intro Screen Controls
    btnStart.addEventListener('click', hideIntro);
    btnCloseIntro.addEventListener('click', hideIntro);
    helpButton.addEventListener('click', showIntro);
  </script>
</body>
</html>
